{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Comportamientos de Conducta Disruptiva</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{% static 'CSS/C_disruptiva.css' %}">
    <script>
        // Función para habilitar o deshabilitar el campo de texto según la opción seleccionada
        function habilitarCampoTexto(elemento) {
            var textField = document.getElementById(elemento.id + "-text");
            textField.disabled = (elemento.value !== "Otro");
        }
    </script>    
</head>
<body>
    <h1>Comportamientos de Conducta Disruptiva</h1>
    <form id="formulario" method="POST" action="">
        <label for="perfil_hijo">Seleccionar perfil del hijo:</label>
        <select id="perfil_hijo" name="perfil_hijo">
            <option value="">Ningún perfil de hijo creado</option>
            {% for hijo in hijos %}
                <option value="{{ hijo.id }}">{{ hijo.nombre }}</option>
            {% endfor %}
        </select>
        <div class="form-group additional-fields" id="p1">
            <label for="p1">¿Cuáles son los comportamientos específicos de conducta disruptiva que tu hijo/a ha mostrado?</label>
            <select id="p1" name="p1" onchange="habilitarCampoTexto(this)">
                <option id="p1" name="p1" value="">Seleccionar</option>
                <option id="p1" name="p1" value="Hablar en exceso e interrumpir constantemente">Hablar en exceso e interrumpir constantemente</option>
                <option id="p1" name="p1" value="Hacer ruidos fuertes o inapropiados">Hacer ruidos fuertes o inapropiados</option>
                <option id="p1" name="p1" value="Tener dificultades para mantener la atención">Tener dificultades para mantener la atención</option>
                <option id="p1" name="p1" value="Actuar impulsivamente sin considerar las consecuencias">Actuar impulsivamente sin considerar las consecuencias</option>
                <option id="p1" name="p1" value="Otro">Otro (especificar)</option>
            </select>
            <input type="text" id="p1-text" name="p1" disabled><br>
        </div>

        <div id="p2">
            <label for="p2">¿En qué contextos o situaciones suele mostrar tu hijo/a estos comportamientos disruptivos?</label>
            <select id="p2" name="p2" onchange="habilitarCampoTexto(this)">
                <option id="p2" name="p2" value="">Seleccionar</option>
                <option id="p2" name="p2" value="En casa">En casa</option>
                <option id="p2" name="p2" value="En la escuela">En la escuela</option>
                <option id="p2" name="p2" value="En entornos sociales">En entornos sociales</option>
                <option id="p2" name="p2" value="En todos los entornos">En todos los entornos</option>
                <option id="p2" name="p2" value="Otro">Situaciones específicas (especificar)</option>
            </select>
            <input type="text" id="p2-text" name="p2" disabled><br>
        </div>

        <div id="p3">
            <label for="p3">¿Has notado algún patrón o desencadenante particular para los comportamientos disruptivos de tu hijo/a?</label>
            <select id="p3" name="p3">
                <option id="p3" name="p3" value="">Seleccionar</option>
                <option id="p3" name="p3" value="Cambios en la rutina diaria">Cambios en la rutina diaria</option>
                <option id="p3" name="p3" value="Situaciones de estrés o ansiedad">Situaciones de estrés o ansiedad</option>
                <option id="p3" name="p3" value="Falta de atención o aburrimiento">Falta de atención o aburrimiento</option>
                <option id="p3" name="p3" value="Interacciones con ciertas personas">Interacciones con ciertas personas</option>
                <option id="p3" name="p3" value="No hay un patrón claro">No hay un patrón claro</option>
            </select>
        </div>

        <div id="p4">
            <label for="p4">¿Cómo has intentado abordar o manejar los comportamientos disruptivos de tu hijo/a hasta ahora?</label>
            <select id="p4" name="p4" onchange="habilitarCampoTexto(this)">
                <option id="p4" name="p4" value="">Seleccionar</option>
                <option id="p4" name="p4" value="Estableciendo límites claros y consistentes">Estableciendo límites claros y consistentes</option>
                <option id="p4" name="p4" value="Proporcionando recompensas o incentivos por comportamientos positivos">Proporcionando recompensas o incentivos por comportamientos positivos</option>
                <option id="p4" name="p4" value="Utilizando técnicas de relajación o regulación emocional">Utilizando técnicas de relajación o regulación emocional</option>
                <option id="p4" name="p4" value="Solicitando apoyo o asesoramiento de profesionales">Solicitando apoyo o asesoramiento de profesionales</option>
                <option id="p4" name="p4" value="Otro">Otro (especificar)</option>
            </select>
            <input type="text" id="p4-text" name="p4" disabled><br>
        </div>

        <div id="p5">
            <label for="p5">¿Has buscado alguna estrategia o recurso adicional para lidiar con los comportamientos disruptivos de tu hijo/a?</label>
            <select id="p5" name="p5">
                <option id="p5" name="p5" value="">Seleccionar</option>
                <option id="p5" name="p5" value="Participación en terapia individual o familiar">Participación en terapia individual o familiar</option>
                <option id="p5" name="p5" value="Programas de desarrollo de habilidades sociales o emocionales">Programas de desarrollo de habilidades sociales o emocionales</option>
                <option id="p5" name="p5" value="Apoyo de profesionales de la educación (psicólogos escolares, orientadores, etc.)">Apoyo de profesionales de la educación (psicólogos escolares, orientadores, etc.)</option>
                <option id="p5" name="p5" value="Lectura de libros o recursos sobre manejo de la conducta">Lectura de libros o recursos sobre manejo de la conducta</option>
                <option id="p5" name="p5" value="No he buscado ninguna estrategia o recurso adicional">No he buscado ninguna estrategia o recurso adicional</option>
            </select>
        </div>
        <input type="hidden" id="perfil_hijo_seleccionado" name="perfil_hijo_seleccionado" value="">
        <a href="{% url 'inicio' %}">Volver a la pantalla de inicio</a>
        <form id="myform" onsubmit="submitForm();">
            {% csrf_token %}
            <input type="hidden" name="hiddenMessage" id="hiddenMessage">
            <button type="submit">Enviar</button>
        </form>
    </form>
    <div id="loading-overlay">
        <div id="loading-indicator"></div>
        <div id="loading-message">Enviando datos, espere un momento...</div>
    </div>
    <script>
        function showLoadingOverlay() {
        document.getElementById('loading-overlay').style.display = 'flex';
        }

        // Función para ocultar el overlay de carga
        function hideLoadingOverlay() {
            document.getElementById('loading-overlay').style.display = 'none';
        }

        // Agregar el evento 'submit' al formulario y mostrar el overlay cuando se envíe
        document.getElementById('formulario').addEventListener('submit', function() {
            showLoadingOverlay();
        });
        function submitForm() {
            // Obtener el mensaje del formulario
            var message = document.getElementById('message').value;

            // Construir el objeto de mensaje
            var chatMessage = {
                role: 'user',
                content: message
            };

            // Convertir el objeto de mensaje en una cadena JSON
            var chatMessageJSON = JSON.stringify(chatMessage);

            // Guardar el mensaje en el almacenamiento local
            localStorage.setItem('chatMessage', chatMessageJSON);
            }
    </script>
</body>
</html>
