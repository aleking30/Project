{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Problemas de Conducta Social</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{% static 'CSS/P_D_C_social.css' %}">
    <script>
        // Función para habilitar o deshabilitar el campo de texto según la opción seleccionada
        function habilitarCampoTexto(elemento) {
            var textField = document.getElementById(elemento.id + "-text");
            textField.disabled = (elemento.value !== "otro");
        }
    </script>
</head>
<body>
    <h1>Problemas de Conducta Social</h1>
    <form id="formulario" method="POST" action="">
        <label for="perfil_hijo">Seleccionar perfil del hijo:</label>
        <select id="perfil_hijo" name="perfil_hijo">
            <option value="">Ningún perfil de hijo creado</option>
            {% for hijo in hijos %}
                <option value="{{ hijo.id }}">{{ hijo.nombre }}</option>
            {% endfor %}
        </select>
        <div class="form-group additional-fields" id="p1">
            <label for="p1">¿En qué situaciones específicas tu hijo/a muestra problemas de conducta social?</label>
            <select id="p1" name="p1" onchange="habilitarCampoTexto(this)">
                <option id="p1" name="p1" value="">Seleccionar</option>
                <option id="p1" name="p1" value="En el entorno escolar">En el entorno escolar</option>
                <option id="p1" name="p1" value="En situaciones de juego o interacción con otros niños">En situaciones de juego o interacción con otros niños</option>
                <option id="p1" name="p1" value="En eventos o actividades sociales">En eventos o actividades sociales</option>
                <option id="p1" name="p1" value="En todos los entornos">En todos los entornos</option>
                <option id="p1" name="p1" value="otro">Otro (especificar)</option>
            </select>
            <input type="text" id="p1-text" name="p1" disabled><br>
        </div>
        <div id = "p2">
            <label for="p2">¿Cuáles son los comportamientos problemáticos de conducta social que tu hijo/a muestra?</label>
            <select id="p2" name="p2" onchange="habilitarCampoTexto(this)">
                <option id="p2" name="p2" value="">Seleccionar</option>
                <option id="p2" name="p2" value="Dificultad para respetar el espacio personal de los demás">Dificultad para respetar el espacio personal de los demás</option>
                <option id="p2" name="p2" value="Falta de empatía o comprensión de las emociones de los demás">Falta de empatía o comprensión de las emociones de los demás</option>
                <option id="p2" name="p2" value="Tendencia a interrumpir o hablar demasiado">Tendencia a interrumpir o hablar demasiado</option>
                <option id="p2" name="p2" value="Problemas para compartir o tomar turnos en las actividades">Problemas para compartir o tomar turnos en las actividades</option>
                <option id="p2" name="p2" value="otro">Otro (especificar)</option>
            </select>
            <input type="text" id="p2-text" name="p2" disabled><br>
        </div>
        <div id = "p3">
            <label for="p3">¿Has notado algún patrón o factores desencadenantes específicos para los problemas de conducta social de tu hijo/a?</label>
            <select id="p3" name="p3">
                <option id="p3" name="p3" value="">Seleccionar</option>
                <option id="p3" name="p3" value="Situaciones de competencia o conflicto con otros niños">Situaciones de competencia o conflicto con otros niños</option>
                <option id="p3" name="p3" value="Cambios en la rutina o entorno">Cambios en la rutina o entorno</option>
                <option id="p3" name="p3" value="Estrés emocional o dificultades personales">Estrés emocional o dificultades personales</option>
                <option id="p3" name="p3" value="Falta de habilidades sociales o de comunicación">Falta de habilidades sociales o de comunicación</option>
                <option id="p3" name="p3" value="No hay un patrón claro">No hay un patrón claro</option>
            </select>
        </div>
        <div id = "p4">
            <label for="p4">¿Has buscado alguna intervención o estrategia específica para abordar los problemas de conducta social de tu hijo/a?</label>
            <select id="p4" name="p4">
                <option id="p4" name="p4" value="">Seleccionar</option>
                <option id="p4" name="p4" value="Asesoramiento o terapia para mejorar las habilidades sociales">Asesoramiento o terapia para mejorar las habilidades sociales</option>
                <option id="p4" name="p4" value="Participación en programas de desarrollo de habilidades sociales">Participación en programas de desarrollo de habilidades sociales</option>
                <option id="p4" name="p4" value="Comunicación regular con los maestros o profesionales de la escuela">Comunicación regular con los maestros o profesionales de la escuela</option>
                <option id="p4" name="p4" value="Lectura de libros o recursos sobre el desarrollo social y emocional">Lectura de libros o recursos sobre el desarrollo social y emocional</option>
                <option id="p4" name="p4" value="No he buscado ninguna intervención específica">No he buscado ninguna intervención específica</option>
            </select>
        </div>
        <div id = "p5">
            <label for="p5">¿Qué expectativas y metas tienes al buscar una solución para los problemas de conducta social de tu hijo/a?</label>
            <select id="p5" name="p5" onchange="habilitarCampoTexto(this)">
                <option id="p5" name="p5" value="">Seleccionar</option>
                <option id="p5" name="p5" value="Mejorar su capacidad para establecer y mantener relaciones saludables">Mejorar su capacidad para establecer y mantener relaciones saludables</option>
                <option id="p5" name="p5" value="Reducir los conflictos o rechazos que experimenta">Reducir los conflictos o rechazos que experimenta</option>
                <option id="p5" name="p5" value="Ayudarle a desarrollar habilidades de comunicación efectiva">Ayudarle a desarrollar habilidades de comunicación efectiva</option>
                <option id="p5" name="p5" value="Fomentar la empatía y la comprensión de las emociones de los demás">Fomentar la empatía y la comprensión de las emociones de los demás</option>
                <option id="p5" name="p5" value="otro">Otro (especificar)</option>
            </select>
            <input type="text" id="p5-text" name="p5" disabled><br>
        </div>
        <input type="hidden" id="perfil_hijo_seleccionado" name="perfil_hijo_seleccionado" value="">
        <a href="{% url 'inicio' %}">Volver a la pantalla de inicio</a>
        <form id="myform" onsubmit="submitForm();">
            {% csrf_token %}
            <input type="hidden" name="hiddenMessage" id="hiddenMessage">
            <button type="submit">Enviar</button>
        </form>
    </form>
    <div id="loading-overlay">
        <div id="loading-indicator"></div>
        <div id="loading-message">Enviando datos, espere un momento...</div>
    </div>
    <script>
        function showLoadingOverlay() {
        document.getElementById('loading-overlay').style.display = 'flex';
        }

        // Función para ocultar el overlay de carga
        function hideLoadingOverlay() {
            document.getElementById('loading-overlay').style.display = 'none';
        }

        // Agregar el evento 'submit' al formulario y mostrar el overlay cuando se envíe
        document.getElementById('formulario').addEventListener('submit', function() {
            showLoadingOverlay();
        });
        function submitForm() {
            // Obtener el mensaje del formulario
            var message = document.getElementById('message').value;

            // Construir el objeto de mensaje
            var chatMessage = {
                role: 'user',
                content: message
            };

            // Convertir el objeto de mensaje en una cadena JSON
            var chatMessageJSON = JSON.stringify(chatMessage);

            // Guardar el mensaje en el almacenamiento local
            localStorage.setItem('chatMessage', chatMessageJSON);
            }
    </script>
</body>
</html>
